name: Test Deploy with private runner

on:
  workflow_dispatch:

env:
  ARM_SUBSCRIPTION_ID: xxxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxx
  ARM_USE_MSI: true

jobs:
  build:
    runs-on: self-hosted
    steps:
    - name: Setup Nodejs
      uses: actions/setup-node@v1
    - name: Checkout
      uses: actions/checkout@v2
    - name: Install TF
      uses: hashicorp/setup-terraform@v1
      with:
        terraform_version: 1.1.0
    - name: Run TF apply
      run: |
        cd test
        terraform init
        terraform apply -auto-approve
        terraform destroy -auto-approve
